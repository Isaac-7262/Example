<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ЁЯР▒ Cat Caf├й POS - р╕гр╕░р╕Ър╕Ър╕Вр╕▓р╕вр╕лр╕Щр╣Йр╕▓р╕гр╣Йр╕▓р╕Щ</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
<link rel="stylesheet" href="css/common.css">
<link rel="stylesheet" href="css/pos.css">
</head>
<body>

<div class="container">
  <aside class="sidebar">
    <div class="logo">
      <img src="images/cat-pos-logo.png" alt="Cat Caf├й POS Logo" class="logo-image">
      <span class="logo-text">Cat Caf├й POS</span>
    </div>
    <ul class="nav-menu">
      <li class="nav-item">
        <a href="index.html" class="nav-link active" data-section="pos">
          <span class="nav-icon">ЁЯЫТ</span> р╕лр╕Щр╣Йр╕▓р╕Ир╕нр╕Вр╕▓р╕в
        </a>
      </li>
      <li class="nav-item">
        <a href="products.html" class="nav-link" data-section="products">
          <span class="nav-icon">ЁЯзЛ</span> р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Ар╕бр╕Щр╕╣
        </a>
      </li>
      <li class="nav-item">
        <a href="customers.html" class="nav-link" data-section="customers">
          <span class="nav-icon">ЁЯСе</span> р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╕╣р╕Бр╕Др╣Йр╕▓
        </a>
      </li>
      <li class="nav-item">
        <a href="reports.html" class="nav-link" data-section="reports">
          <span class="nav-icon">ЁЯУК</span> р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Вр╕▓р╕в
        </a>
      </li>
      <li class="nav-item">
        <a href="employees.html" class="nav-link" data-section="employees">
          <span class="nav-icon">ЁЯСитАНЁЯТ╝</span> р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Юр╕Щр╕▒р╕Бр╕Зр╕▓р╕Щ
        </a>
      </li>
      <li class="nav-item">
        <a href="settings.html" class="nav-link" data-section="settings">
          <span class="nav-icon">тЪЩя╕П</span> р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓
        </a>
      </li>
    </ul>
  </aside>

  <main class="main-content">
    <header class="header">
      <div class="search-box">
        <input type="text" class="search-input" placeholder="ЁЯФН р╕Др╣Йр╕Щр╕лр╕▓р╣Ар╕бр╕Щр╕╣..." id="searchInput">
      </div>
      <div class="user-info">
        <span id="currentUserDisplay">ЁЯСд р╕Юр╕Щр╕▒р╕Бр╕Зр╕▓р╕Щ: р╕Бр╕│р╕ер╕▒р╕Зр╣Вр╕лр╕ер╕Ф...</span>
        <span>ЁЯУЕ <span id="currentDate"></span></span>
        <button class="btn btn-danger" onclick="logout()" style="margin-left: 15px; padding: 8px 16px;">ЁЯЪк р╕нр╕нр╕Бр╕Ир╕▓р╕Бр╕гр╕░р╕Ър╕Ъ</button>
      </div>
    </header>

    <section id="pos" class="content-section active">
      <div class="pos-grid">
        <div class="products-section card">
          <div class="card-header">
            <h2>ЁЯзЛ р╣Ар╕ер╕╖р╕нр╕Бр╣Ар╕бр╕Щр╕╣</h2>
          </div>
          <div class="category-tabs" id="categoryTabs"></div>
          <div class="products-grid" id="productsGrid"></div>
        </div>

        <div class="cart-section">
          <div class="cart-header">
            <span>ЁЯЫТ р╕Хр╕░р╕Бр╕гр╣Йр╕▓р╕кр╕┤р╕Щр╕Др╣Йр╕▓</span>
          </div>
          <div class="cart-items" id="cartItems"></div>
          <div class="cart-total">
            <div class="cart-total-amount">р╕┐<span id="cartTotal">0.00</span></div>
            <div>р╕гр╕зр╕бр╕Чр╕▒р╣Йр╕Зр╕кр╕┤р╣Йр╕Щ</div>
          </div>
          <button class="btn btn-success" style="width:100%;margin-bottom:12px;" id="btnPay">
            ЁЯТ│ р╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щ
          </button>
          <button class="btn btn-danger" style="width:100%;" id="btnClear">
            ЁЯЧСя╕П р╕ер╣Йр╕▓р╕Зр╕Хр╕░р╕Бр╕гр╣Йр╕▓
          </button>
        </div>
      </div>
    </section>
  </main>
</div>

<div id="paymentMethodModal" class="modal">
    <div class="modal-content payment-modal-content">
        <h3 style="margin-bottom: 16px;">ЁЯЫТ р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕гр╕▓р╕вр╕Бр╕▓р╕гр╣Бр╕ер╕░р╣Ар╕ер╕╖р╕нр╕Бр╕зр╕┤р╕Шр╕╡р╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щ</h3>

        <!-- р╕кр╣Ир╕зр╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╕╣р╕Бр╕Др╣Йр╕▓ -->
        <div class="customer-section" style="background: #fff8e1; padding: 14px 16px; border-radius: 12px; margin-bottom: 16px; border: 2px solid #ffcc80;">
            <h4 style="margin-bottom: 10px; color: #ff9800;">ЁЯСд р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╕╣р╕Бр╕Др╣Йр╕▓ (р╣Др╕бр╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ)</h4>
            <div style="display: grid; grid-template-columns: minmax(0,1fr) auto; gap: 12px; align-items: end;">
                <div class="customer-search-input-wrapper">
                    <label style="display: block; margin-bottom: 5px; font-weight: 500;">р╕Др╣Йр╕Щр╕лр╕▓р╕ер╕╣р╕Бр╕Др╣Йр╕▓ (р╕Кр╕╖р╣Ир╕н р╕лр╕гр╕╖р╕н р╣Ар╕Ър╕нр╕гр╣Мр╣Вр╕Чр╕г)</label>
                    <input type="text" id="customerSearch" class="form-input" placeholder="р╕Юр╕┤р╕бр╕Юр╣Мр╕Кр╕╖р╣Ир╕нр╕лр╕гр╕╖р╕нр╣Ар╕Ър╕нр╕гр╣Мр╣Вр╕Чр╕гр╣Ар╕Юр╕╖р╣Ир╕нр╕Др╣Йр╕Щр╕лр╕▓..." style="margin-bottom: 0;">
                    <div id="customerSearchResults" class="search-results" style="display: none;"></div>
                </div>
                <button type="button" class="btn btn-secondary" onclick="clearSelectedCustomer(); hideCustomerSearchResults();">р╕вр╕Бр╣Ар╕ер╕┤р╕Б</button>
            </div>
            <div id="selectedCustomerInfo" style="display: none; margin-top: 12px; padding: 12px; background: white; border-radius: 10px; border: 2px solid #81c784;">
                <div id="customerDetails"></div>
                <div id="loyaltyInfo" style="margin-top: 10px;"></div>
            </div>
        </div>

        <div id="paymentReviewItems" style="margin-bottom: 16px; border: 2px solid #ffe0b2; border-radius: 12px; padding: 10px 12px;">
        </div>
        <div class="payment-total-display">
            <div style="font-size: 2em; font-weight: bold; color: #ff9800;">
                р╕┐<span id="paymentModalTotal">0.00</span>
            </div>
            <div id="loyaltyDiscount" style="display: none; color: #4caf50; font-size: 1.2em; margin-top: 10px;">
                ЁЯОЙ р╣Гр╕Кр╣Йр╣Бр╕Хр╣Йр╕бр╕кр╕░р╕кр╕б: -р╕┐<span id="discountAmount">60.00</span>
            </div>
        </div>
        <div class="payment-method-grid">
            <div class="payment-method-card" onclick="selectPaymentMethod('cash')">
                <div class="payment-icon">ЁЯТ░</div>
                <div class="payment-title">р╣Ар╕Зр╕┤р╕Щр╕кр╕Ф</div>
                <div class="payment-subtitle">Cash Payment</div>
            </div>
            <div class="payment-method-card" onclick="selectPaymentMethod('qr')">
                <div class="payment-icon">ЁЯУ▒</div>
                <div class="payment-title">р╕кр╣Бр╕Бр╕Щр╕Ир╣Ир╕▓р╕в</div>
                <div class="payment-subtitle">QR Code / Mobile Banking</div>
            </div>
        </div>
        <div style="text-align: center; margin-top: 25px;">
            <button class="btn btn-danger" onclick="cancelPaymentFlow('paymentMethodModal')">тЭМ р╕вр╕Бр╣Ар╕ер╕┤р╕Б</button>
        </div>
    </div>
</div>

<div id="paymentModal" class="modal">
    <div class="modal-content">
        <h3 id="paymentTitle"></h3>
        <div id="cashPayment" style="display:none;">
            <div class="form-group"><label class="form-label">р╕вр╕нр╕Фр╕гр╕зр╕б</label><input type="text" class="form-input" id="totalAmount" readonly></div>
            <div class="form-group"><label class="form-label">р╕гр╕▒р╕Ър╣Ар╕Зр╕┤р╕Щр╕кр╕Ф</label><input type="number" class="form-input" id="cashReceived"></div>
            <div class="form-group"><label class="form-label">р╣Ар╕Зр╕┤р╕Щр╕Чр╕нр╕Щ</label><input type="text" class="form-input" id="changeAmount" readonly></div>
        </div>
        <div id="qrPayment" style="display:none; text-align:center;">
            <h4>ЁЯУ▒ р╕кр╣Бр╕Бр╕Щ QR Code р╣Ар╕Юр╕╖р╣Ир╕нр╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щ</h4>
            <div class="qr-code" style="margin:15px auto;">ЁЯУ▒</div>
            <p>р╕вр╕нр╕Фр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Кр╕│р╕гр╕░: <b>р╕┐<span id="qrAmount">0.00</span></b></p>
        </div>
        <div style="display:flex; gap:10px; justify-content:center; margin-top:20px;">
            <button class="btn btn-success" id="confirmPayment">тЬЕ р╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щ</button>
            <button class="btn btn-danger" onclick="cancelPaymentFlow('paymentModal')">р╕вр╕Бр╣Ар╕ер╕┤р╕Б</button>
        </div>
    </div>
</div>

<div id="receiptModal" class="modal">
    <div class="modal-content">
        <div class="receipt" id="receiptContent"></div>
        <div style="text-align:center; margin-top:20px; display:flex; gap:10px; justify-content:center;">
            <button class="btn btn-secondary" onclick="printReceipt()">ЁЯЦия╕П р╕Юр╕┤р╕бр╕Юр╣М</button>
            <button class="btn btn-primary" onclick="emailReceipt()">ЁЯУз р╕кр╣Ир╕Зр╕нр╕╡р╣Ар╕бр╕е</button>
            <button class="btn btn-danger" onclick="closeModal('receiptModal')">р╕Ыр╕┤р╕Ф</button>
        </div>
    </div>
</div>

<script src="js/common.js"></script>
<script src="js/pos.js"></script>
</body>
</html>